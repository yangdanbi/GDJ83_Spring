<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.winter.app.member.MemberDAO">

<!-- resultType은 없지만 int가 리턴 -->
	<select id="join" parameterType="MemberDTO">
		INSERT INTO MEMBER 
		VALUES(#{member_id},#{member_pwd},#{member_name},#{member_number},
		#{phone},#{email})
	</select>
		
	<select id="login" parameterType="MemberDTO" resultType="memberDTO" >
		SELECT MEMBER_ID,MEMBER_PWD,MEMBER_NAME
		FROM MEMBER
		WHERE MEMBER_ID =#{member_id}
	</select>
	
	<select id="detail" parameterType="MemberDTO" resultMap="loginResult">
		SELECT M.*,P.*
		FROM MEMBER M 
			 LEFT JOIN 
			 PRODUCT_INFO P
			 	ON M.MEMBER_ID = P.MEMBER_ID
		WHERE M.MEMBER_ID =#{member_id}
	</select>
	<resultMap type="MemberDTO" id="loginResult">
		<!-- primary Key 용도
		column="컬럼명" property="setter의 이름"
		member  -->
		<id column="MEMBER_ID" property="member_id"/>
		<result column="MEMBER_PWD" property="member_pwd"/> 
		<result column="MEMBER_NAME" property="member_name"/> 
		<result column="MEMBER_NUMBER" property="member_number"/> 
		<result column="PHONE" property="phone"/> 
		<result column="EMAIL" property="email"/> 
		<!-- 1:N 통장 product_info  -->
		<collection property="dtos" javaType="java.util.List" ofType="AccountDTO">
			<id column="PRODUCT_ID" property="product_id"/>
			<result column="JOIN_DATE" property="join_date"/>
			<result column="ACCOUNT_NUMBER" property="account_number"/>
			<result column="BALANCE" property="balance"/>
		</collection>
	
	
	</resultMap> 

	<select id="mypage" parameterType="MemberDTO" resultType="MemberDTO">
		SELECT *
		FROM MEMBER
		WHERE MEMBER_ID =#{member_id}
	</select>
	
	<select id="update" parameterType="MemberDTO" >
		UPDATE MEMBER 
		SET MEMBER_NAME = #{member_name},PHONE = #{phone}, EMAIL = #{email}  
		WHERE MEMBER_ID = #{member_id}
	</select>
	
	<select id="delete"  parameterType="MemberDTO" >
		DELETE FROM MEMBER
		WHERE MEMBER_ID = #{member_id}
	</select>
	
</mapper>